---
description:
globs:
alwaysApply: true
---
# NestJS æ¶æ„å¼€å‘æ ‡å‡†

## ğŸ—ï¸ é¡¹ç›®æ¶æ„è§„èŒƒ

### æ ¸å¿ƒç›®å½•ç»“æ„
- `src/` - ä¸»è¦æºä»£ç ç›®å½•
- `src/api/` - å¤–éƒ¨APIè°ƒç”¨å°è£…
- `src/auth/` - è®¤è¯æˆæƒæ¨¡å—
- `src/common/` - å…¬å…±ç»„ä»¶(å¸¸é‡ã€è¿‡æ»¤å™¨ã€å®ˆå«ã€æ‹¦æˆªå™¨ã€ä¸­é—´ä»¶)
- `src/datasources/` - æ•°æ®æºè¿æ¥å™¨(MySQLã€Redisã€MongoDBã€ESã€Kafkaã€Apollo)
- `src/global/` - å…¨å±€æœåŠ¡ç®¡ç†
- `src/utils/` - å·¥å…·å‡½æ•°åº“
- `prisma/` - æ•°æ®åº“Schemaå’Œè¿ç§»æ–‡ä»¶

### æ•°æ®æºç®¡ç†è§„èŒƒ
å‚è€ƒ [src/datasources](mdc:src/datasources) ç›®å½•ç»“æ„ï¼š

#### å¿…éœ€æ•°æ®æºï¼ˆä¸ªäººé¡¹ç›®ï¼‰
- **Prisma/MySQL**: [src/datasources/prisma](mdc:src/datasources/prisma) - ä¸»æ•°æ®åº“
- **Redis**: [src/datasources/redis](mdc:src/datasources/redis) - ç¼“å­˜ç³»ç»Ÿ

#### å¯é€‰æ•°æ®æºï¼ˆæŒ‰éœ€å¯ç”¨ï¼‰
- **MongoDB**: [src/datasources/mongodb](mdc:src/datasources/mongodb) - æ–‡æ¡£æ•°æ®åº“
- **Elasticsearch**: [src/datasources/es](mdc:src/datasources/es) - æœç´¢å¼•æ“
- **Kafka**: [src/datasources/kafka](mdc:src/datasources/kafka) - æ¶ˆæ¯é˜Ÿåˆ—
- **Apollo**: [src/datasources/appollo](mdc:src/datasources/appollo) - é…ç½®ä¸­å¿ƒ

### æ¨¡å—è®¾è®¡åŸåˆ™
1. **å•ä¸€èŒè´£**: æ¯ä¸ªæ¨¡å—åªè´Ÿè´£ä¸€ä¸ªå…·ä½“åŠŸèƒ½
2. **ä¾èµ–æ³¨å…¥**: ä½¿ç”¨NestJSçš„DIå®¹å™¨ç®¡ç†ä¾èµ–
3. **æ¥å£åˆ†ç¦»**: Controllerã€Serviceã€Repositoryåˆ†å±‚
4. **é…ç½®å¤–éƒ¨åŒ–**: ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®

### æ–‡ä»¶å‘½åè§„èŒƒ
- Controller: `*.controller.ts`
- Service: `*.service.ts`
- Module: `*.module.ts`
- DTO: `*.dto.ts`
- Guard: `*.guard.ts`
- Interceptor: `*.interceptor.ts`
- Filter: `*.filter.ts`

## ğŸ”§ æœåŠ¡æ³¨å†Œè§„èŒƒ

### GlobalServiceä½¿ç”¨
å‚è€ƒ [src/global/global.service.ts](mdc:src/global/global.service.ts)ï¼š
- æ‰€æœ‰æ•°æ®æºè¿æ¥é€šè¿‡GlobalServiceç»Ÿä¸€ç®¡ç†
- ä½¿ç”¨setteræ–¹æ³•æ³¨å†Œæ•°æ®æºå®ä¾‹
- é€šè¿‡getteræ–¹æ³•è·å–æ•°æ®æºå®ä¾‹

### æ•°æ®æºè¿æ¥è§„èŒƒ
å‚è€ƒ [src/datasources/appollo/apolloClient.service.ts](mdc:src/datasources/appollo/apolloClient.service.ts)ï¼š
- æ”¯æŒApolloé…ç½®é©±åŠ¨å’Œç¯å¢ƒå˜é‡ä¸¤ç§é…ç½®æ–¹å¼
- å®ç°ä¼˜é›…çš„è¿æ¥å¤±è´¥å¤„ç†
- æä¾›è¿æ¥çŠ¶æ€ç›‘æ§å’Œæ—¥å¿—è®°å½•

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### æ–°å»ºæ¨¡å—æ—¶å¿…é¡»åŒ…å«
- [ ] Moduleæ–‡ä»¶å®šä¹‰
- [ ] Controllerå¤„ç†HTTPè¯·æ±‚
- [ ] Serviceå®ç°ä¸šåŠ¡é€»è¾‘
- [ ] DTOå®šä¹‰æ•°æ®ä¼ è¾“å¯¹è±¡
- [ ] å•å…ƒæµ‹è¯•æ–‡ä»¶

### æ•°æ®æºé›†æˆæ£€æŸ¥
- [ ] ç¡®è®¤æ•°æ®æºæ˜¯å¦å¿…éœ€
- [ ] é…ç½®è¿æ¥å‚æ•°
- [ ] å®ç°è¿æ¥é”™è¯¯å¤„ç†
- [ ] æ·»åŠ å¥åº·æ£€æŸ¥
- [ ] æ›´æ–°GlobalServiceæ³¨å†Œ
