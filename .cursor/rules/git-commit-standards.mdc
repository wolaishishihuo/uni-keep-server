---
description:
globs:
alwaysApply: true
---
# Git æäº¤è§„èŒƒ

## ğŸ”„ æäº¤ä¿¡æ¯æ ¼å¼

### åŸºæœ¬æ ¼å¼
```
<type>(<scope>): <subject>

<body>

<footer>
```

### è¯¦ç»†è¯´æ˜
- **type**: æäº¤ç±»å‹ï¼ˆå¿…éœ€ï¼‰
- **scope**: å½±å“èŒƒå›´ï¼ˆå¯é€‰ï¼‰
- **subject**: ç®€çŸ­æè¿°ï¼ˆå¿…éœ€ï¼‰
- **body**: è¯¦ç»†æè¿°ï¼ˆå¯é€‰ï¼‰
- **footer**: å…³è”issueæˆ–ç ´åæ€§å˜æ›´ï¼ˆå¯é€‰ï¼‰

## ğŸ“ æäº¤ç±»å‹ (Type)

### ä¸»è¦ç±»å‹
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- `refactor`: é‡æ„ä»£ç ï¼ˆä¸æ˜¯æ–°åŠŸèƒ½ä¹Ÿä¸æ˜¯ä¿®å¤bugï¼‰
- `perf`: æ€§èƒ½ä¼˜åŒ–
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨
- `ci`: CI/CDç›¸å…³å˜æ›´
- `build`: æ„å»ºç³»ç»Ÿæˆ–å¤–éƒ¨ä¾èµ–å˜æ›´

### ç‰¹æ®Šç±»å‹
- `hotfix`: ç´§æ€¥ä¿®å¤
- `revert`: å›æ»šæäº¤
- `merge`: åˆå¹¶åˆ†æ”¯
- `init`: åˆå§‹åŒ–é¡¹ç›®

## ğŸ¯ å½±å“èŒƒå›´ (Scope)

### æ¨¡å—èŒƒå›´
- `auth`: è®¤è¯æˆæƒæ¨¡å—
- `user`: ç”¨æˆ·ç®¡ç†æ¨¡å—
- `api`: APIæ¥å£
- `db`: æ•°æ®åº“ç›¸å…³
- `config`: é…ç½®ç›¸å…³
- `middleware`: ä¸­é—´ä»¶
- `guard`: å®ˆå«
- `interceptor`: æ‹¦æˆªå™¨
- `filter`: è¿‡æ»¤å™¨
- `dto`: æ•°æ®ä¼ è¾“å¯¹è±¡
- `service`: æœåŠ¡å±‚
- `controller`: æ§åˆ¶å™¨
- `module`: æ¨¡å—

### æŠ€æœ¯èŒƒå›´
- `prisma`: Prismaç›¸å…³
- `redis`: Redisç›¸å…³
- `mongodb`: MongoDBç›¸å…³
- `es`: Elasticsearchç›¸å…³
- `kafka`: Kafkaç›¸å…³
- `apollo`: Apolloé…ç½®ä¸­å¿ƒ
- `docker`: Dockerç›¸å…³
- `deps`: ä¾èµ–æ›´æ–°

## âœ… æäº¤ä¿¡æ¯ç¤ºä¾‹

### åŠŸèƒ½å¼€å‘
```bash
# æ–°å¢ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
git commit -m "feat(auth): add user registration with email verification"

# æ–°å¢ç”¨æˆ·ç®¡ç†API
git commit -m "feat(user): implement user CRUD operations"

# æ–°å¢Redisç¼“å­˜
git commit -m "feat(redis): add user session caching"
```

### Bugä¿®å¤
```bash
# ä¿®å¤ç™»å½•é—®é¢˜
git commit -m "fix(auth): resolve JWT token expiration issue"

# ä¿®å¤æ•°æ®åº“è¿æ¥
git commit -m "fix(db): handle prisma connection timeout"

# ä¿®å¤APIå“åº”æ ¼å¼
git commit -m "fix(api): correct response format for user endpoints"
```

### æ–‡æ¡£æ›´æ–°
```bash
# æ›´æ–°APIæ–‡æ¡£
git commit -m "docs(api): update user endpoints documentation"

# æ›´æ–°README
git commit -m "docs: update project setup instructions"
```

### é‡æ„ä»£ç 
```bash
# é‡æ„ç”¨æˆ·æœåŠ¡
git commit -m "refactor(user): optimize user service performance"

# é‡æ„æ•°æ®åº“è¿æ¥
git commit -m "refactor(db): improve prisma connection management"
```

### æµ‹è¯•ç›¸å…³
```bash
# æ·»åŠ å•å…ƒæµ‹è¯•
git commit -m "test(user): add unit tests for user service"

# ä¿®å¤æµ‹è¯•ç”¨ä¾‹
git commit -m "test(auth): fix authentication test cases"
```

### é…ç½®å˜æ›´
```bash
# æ›´æ–°ä¾èµ–
git commit -m "chore(deps): update nestjs to v11.0.0"

# æ›´æ–°Dockeré…ç½®
git commit -m "chore(docker): optimize dockerfile for production"

# æ›´æ–°CIé…ç½®
git commit -m "ci: add automated testing workflow"
```

## ğŸ“‹ è¯¦ç»†æäº¤ç¤ºä¾‹

### åŒ…å«è¯¦ç»†æè¿°çš„æäº¤
```bash
git commit -m "feat(auth): implement JWT refresh token mechanism

- Add refresh token generation and validation
- Implement token rotation for enhanced security
- Add refresh endpoint to auth controller
- Update auth guard to handle refresh tokens
- Add unit tests for refresh token functionality

Closes #123"
```

### ç ´åæ€§å˜æ›´
```bash
git commit -m "feat(api): redesign user API response format

BREAKING CHANGE: User API now returns nested user object instead of flat structure.

Before:
{
  \"id\": \"1\",
  \"name\": \"John\",
  \"email\": \"john@example.com\"
}

After:
{
  \"user\": {
    \"id\": \"1\",
    \"profile\": {
      \"name\": \"John\",
      \"email\": \"john@example.com\"
    }
  }
}

Closes #456"
```

## ğŸ”§ æäº¤è§„èŒƒé…ç½®

### Commitlint é…ç½®
å‚è€ƒ [commitlint.config.js](mdc:commitlint.config.js)ï¼š

```javascript
module.exports = {
  extends: ['@commitlint/config-conventional'],
  rules: {
    'type-enum': [
      2,
      'always',
      [
        'feat',
        'fix',
        'docs',
        'style',
        'refactor',
        'perf',
        'test',
        'chore',
        'ci',
        'build',
        'hotfix',
        'revert',
        'merge',
        'init'
      ]
    ],
    'scope-enum': [
      2,
      'always',
      [
        'auth',
        'user',
        'api',
        'db',
        'config',
        'middleware',
        'guard',
        'interceptor',
        'filter',
        'dto',
        'service',
        'controller',
        'module',
        'prisma',
        'redis',
        'mongodb',
        'es',
        'kafka',
        'apollo',
        'docker',
        'deps'
      ]
    ],
    'subject-max-length': [2, 'always', 100],
    'subject-min-length': [2, 'always', 10],
    'subject-case': [2, 'always', 'lower-case'],
    'subject-empty': [2, 'never'],
    'subject-full-stop': [2, 'never', '.'],
    'type-case': [2, 'always', 'lower-case'],
    'type-empty': [2, 'never']
  }
};
```

### Husky Git Hooks
```json
{
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged",
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS",
      "pre-push": "npm run test"
    }
  }
}
```

### Lint-staged é…ç½®
```json
{
  "lint-staged": {
    "*.{js,ts}": [
      "eslint --fix",
      "prettier --write",
      "git add"
    ],
    "*.{json,md}": [
      "prettier --write",
      "git add"
    ]
  }
}
```

## ğŸŒ¿ åˆ†æ”¯ç®¡ç†è§„èŒƒ

### åˆ†æ”¯å‘½åè§„èŒƒ
```bash
# åŠŸèƒ½åˆ†æ”¯
feature/åŠŸèƒ½æè¿°
feature/user-authentication
feature/payment-integration

# ä¿®å¤åˆ†æ”¯
fix/é—®é¢˜æè¿°
fix/login-timeout-issue
fix/database-connection-error

# çƒ­ä¿®å¤åˆ†æ”¯
hotfix/ç´§æ€¥é—®é¢˜æè¿°
hotfix/security-vulnerability
hotfix/critical-bug-fix

# å‘å¸ƒåˆ†æ”¯
release/ç‰ˆæœ¬å·
release/v1.0.0
release/v1.2.3

# å¼€å‘åˆ†æ”¯
develop

# ä¸»åˆ†æ”¯
main/master
```

### åˆ†æ”¯å·¥ä½œæµç¨‹
```bash
# 1. ä»ä¸»åˆ†æ”¯åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout main
git pull origin main
git checkout -b feature/user-management

# 2. å¼€å‘è¿‡ç¨‹ä¸­å®šæœŸæäº¤
git add .
git commit -m "feat(user): add user creation endpoint"

# 3. æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯
git push origin feature/user-management

# 4. åˆ›å»ºPull Request
# 5. ä»£ç å®¡æŸ¥é€šè¿‡ååˆå¹¶åˆ°ä¸»åˆ†æ”¯
# 6. åˆ é™¤åŠŸèƒ½åˆ†æ”¯
git branch -d feature/user-management
git push origin --delete feature/user-management
```

## ğŸ“‹ æäº¤æ£€æŸ¥æ¸…å•

### æäº¤å‰æ£€æŸ¥
- [ ] æäº¤ä¿¡æ¯ç¬¦åˆæ ¼å¼è§„èŒƒ
- [ ] æäº¤ç±»å‹æ­£ç¡®
- [ ] å½±å“èŒƒå›´æ˜ç¡®
- [ ] æè¿°ç®€æ´æ˜äº†
- [ ] ä»£ç å·²é€šè¿‡æµ‹è¯•
- [ ] ä»£ç å·²é€šè¿‡lintæ£€æŸ¥

### æäº¤ä¿¡æ¯è´¨é‡æ£€æŸ¥
- [ ] ä½¿ç”¨è‹±æ–‡æè¿°
- [ ] ä½¿ç”¨ç°åœ¨æ—¶æ€
- [ ] é¦–å­—æ¯å°å†™
- [ ] ä¸ä»¥å¥å·ç»“å°¾
- [ ] æè¿°å…·ä½“å˜æ›´å†…å®¹
- [ ] åŒ…å«ç›¸å…³issueç¼–å·

### ç‰¹æ®Šæƒ…å†µå¤„ç†
- [ ] ç ´åæ€§å˜æ›´å·²æ ‡æ³¨BREAKING CHANGE
- [ ] å›æ»šæäº¤åŒ…å«åŸå› è¯´æ˜
- [ ] åˆå¹¶æäº¤åŒ…å«åˆ†æ”¯ä¿¡æ¯
- [ ] çƒ­ä¿®å¤æäº¤æ ‡æ³¨ç´§æ€¥ç¨‹åº¦

## ğŸš¨ å¸¸è§é”™è¯¯ç¤ºä¾‹

### âŒ é”™è¯¯ç¤ºä¾‹
```bash
# ç±»å‹é”™è¯¯
git commit -m "add user login"  # ç¼ºå°‘type

# æè¿°ä¸æ¸…
git commit -m "fix: bug"  # æè¿°å¤ªç®€å•

# æ ¼å¼é”™è¯¯
git commit -m "Fix: User Login Issue"  # é¦–å­—æ¯å¤§å†™

# èŒƒå›´é”™è¯¯
git commit -m "feat: add user login"  # ç¼ºå°‘scope

# æ ‡ç‚¹é”™è¯¯
git commit -m "feat(auth): add user login."  # ä¸åº”ä»¥å¥å·ç»“å°¾
```

### âœ… æ­£ç¡®ç¤ºä¾‹
```bash
# æ ‡å‡†æ ¼å¼
git commit -m "feat(auth): add user login with JWT authentication"

# åŒ…å«è¯¦ç»†æè¿°
git commit -m "fix(db): resolve prisma connection timeout issue

- Increase connection timeout to 30 seconds
- Add connection retry mechanism
- Improve error handling for database failures

Fixes #123"
```

## ğŸ” æäº¤å†å²ç®¡ç†

### æŸ¥çœ‹æäº¤å†å²
```bash
# æŸ¥çœ‹ç®€æ´çš„æäº¤å†å²
git log --oneline

# æŸ¥çœ‹è¯¦ç»†çš„æäº¤å†å²
git log --graph --pretty=format:'%h - %an, %ar : %s'

# æŸ¥çœ‹ç‰¹å®šæ–‡ä»¶çš„æäº¤å†å²
git log --follow -- src/user/user.service.ts
```

### ä¿®æ”¹æäº¤ä¿¡æ¯
```bash
# ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤ä¿¡æ¯
git commit --amend -m "feat(auth): add user authentication with JWT"

# äº¤äº’å¼ä¿®æ”¹å¤šä¸ªæäº¤
git rebase -i HEAD~3
```

---

ä¸¥æ ¼éµå¾ªè¿™äº›Gitæäº¤è§„èŒƒï¼Œç¡®ä¿é¡¹ç›®å†å²æ¸…æ™°ã€å¯è¿½æº¯ï¼
